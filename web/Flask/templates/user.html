{% extends "base.html" %}

{% block content %}
<h1 align='center'>Welcome : {{ user }} / Credit : {{ credit }}</h1>
<h4 align='center'>ศูนย์บริการเครื่องมือวิเคราะห์วัสดุและนาโนเทคโนโลยี</h4>
<h4 align='center'>วิทยาลัยนาโนเทคโนโลยีพระจอมเกล้าลาดกระบัง</h4>
<br>
<div class="container">
    <br>
    <table class="table table-bordered" align="center">
        <thead>
            <tr>
                <th colspan="17" style="text-align:center" >
                    <div class="row">
                        <div class="column" class="pull-left">
                            {% set monx = month-1 %}
                            <a href="/user/{{ year }}-{{ monx }}" "><< Previous {{ monx }}</a>
                        </div>
                        <div class="column">{{ month_text }} {{ year }}</div>
                        <div class="column" class="pull-right">
                            {% set monx = month+1 %}
                            <a href="/user/{{ year }}-{{ monx }}" ">{{ monx }} Next >></a>
                        </div>
                    </div>
                </th>
            </tr>
            <tr style="background-color:gainsboro">
                <th style="text-align:center">เลขที่การจอง</th>
                <th style="text-align:center">เครื่องมือ</th>
                <th style="text-align:center">ผู้ใช้งานเครื่องมือ</th>
                <th style="text-align:center">หมายเลขโทรศัพท์</th>
                <th style="text-align:center">สารที่ทดสอบ</th>
                <th style="text-align:center">บันทึก</th>
                <th style="text-align:center">วันที่ทำการจอง</th>
                <th style="text-align:center">วันที่ใช้เครื่องมือ</th>
                <th style="text-align:center">09-10</th>
                <th style="text-align:center">10-11</th>
                <th style="text-align:center">11-12</th>
                <th style="text-align:center">13-14</th>
                <th style="text-align:center">14-15</th>
                <th style="text-align:center">15-16</th>
                <th style="text-align:center">สถานะ</th>
                <th style="text-align:center">ค่าใช้จ่าย</th>
                <th style="text-align:center">Action</th>
            </tr>
        </thead>
        <tbody>
            {% set count = {'value': 0} %}
            {% for row in data %}
            {% if count.value is divisibleby(2) %}
            <tr style="background-color:white">
            {% else %}
            <tr style="background-color:ivory">
            {% endif %}
                <td style="text-align:center">{{ row.0 }}</td>
                <td style="text-align:center">{{ row.22 }}</td>
                <td style="text-align:center">{{ row.2 }}</td>
                <td style="text-align:center">
                    {% if row.3 %}
                        {{ row.3 }}
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.4 %}
                        {{ row.4 }}
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.17 %}
                        {{ row.17 }}
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">{{ row.5 }}</td>
                <td style="text-align:center">{{ row.6 }}</td>
                <td style="text-align:center">
                    {% if row.7 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.8 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.9 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.10 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.11 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.12 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.13 == "Approve" %}
                        <span style="color:green">{{ row.13 }}</span>
                    {% elif row.13 == "Pending" %}
                        {{ row.13 }}
                    {% else %}
                        <span style="color:red">{{ row.13 }}</span>
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {{ row.15 }}
                </td>
                <td style="text-align:center">
                    {% if action[count.value] > 0 %}
                        {% if row.14 == "Top up" %}
                            ---
                        {% elif row.13 == "Pending" %}
                            <a href="/edit/{{ row.0 }}" class="btn btn-warning btn-xs" onclick="return confirm('คุณต้องการแก้ไขข้อมูลหรือไม่?')">Edit</a>
                            <a href="/cancel/{{ row.0 }}" class="btn btn-danger btn-xs" onclick="return confirm('คุณต้องการยกเลิกการจองหรือไม่?')">Cancel</a>
                        {% elif row.13 == "Approve" %}
                            <a href="/cancel/{{ row.0 }}" class="btn btn-danger btn-xs" onclick="return confirm('คุณต้องการยกเลิกการจองหรือไม่?')">Cancel</a>
                        {% else %}
                            ---
                        {% endif %}
                        {% if count.update({'value': (count.value + 1)}) %} {% endif %}
                    {% else %}
                        ---
                        {% if count.update({'value': (count.value + 1)}) %} {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% if user %}
        <a href="{{ url_for('add_form') }}" class="btn btn-success">จองใช้เครื่องมือ</a>
    {% endif %}
    <span class="pull-right">Updated : <span id="datetime"></span></span>
    <script>
        var dt = new Date();
        document.getElementById("datetime").innerHTML = dt.toLocaleString();
    </script>
    <script>
        $(function () {
            $('#datetimepicker1').datetimepicker({
                daysOfWeekDisabled: [0, 6],
                format: 'L',
                format: 'DD-MM-YYYY'
            });
        });
    </script>
</div>
{% endblock %}
