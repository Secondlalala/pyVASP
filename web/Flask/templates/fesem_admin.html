{% extends "fesem_base.html" %}

{% block content %}
<h1 align='center'>Welcome : {{ user }}</h1>
<h4 align='center'>FESEM-EDX</h4>
<br>
<div class="container">
    <br>
    <table class="table table-bordered" align="center">
        <thead>
            <tr>
                <th colspan="18" style="text-align:center" >
                    <div class="row">
                        <div class="column" class="pull-left">
                            {% set monx = month-1 %}
                            {% if monx == -1 %}
                                {% set monx = 12 %}
                                {% set year = year - 1 %}
                            {% endif %}                            <a href="/fesem_user/{{ year }}-{{ monx }}" "><< Previous {{ monx }}</a>
                        </div>
                        <div class="column">{{ month_text }} {{ year }}</div>
                        <div class="column" class="pull-right">
                            {% set monx = month+1 %}
                            {% if monx == 13 %}
                                {% set monx = 1 %}
                                {% set year = year + 1 %}
                            {% endif %}                            <a href="/fesem_user/{{ year }}-{{ monx }}" ">{{ monx }} Next >></a>
                        </div>
                    </div>
                </th>
            </tr>
            <tr style="background-color:gainsboro">
                <th style="text-align:center">เลขที่การจอง</th>
                <th style="text-align:center">เครื่องมือ</th>
                <th style="text-align:center">ผู้ทำการจอง</th>
                <th style="text-align:center">สารที่ทดสอบ</th>
                <th style="text-align:center">ขนาดของชิ้นงาน</th>
                <th style="text-align:center">สิ่งที่ต้องการตรวจสอบ</th>
                <th style="text-align:center">จำนวนชิ้นงาน</th>
                <th style="text-align:center">Coating</th>
                <th style="text-align:center">บันทึก</th>
                <th style="text-align:center">วันที่ทำการจอง</th>
                <th style="text-align:center">วันที่ใช้เครื่องมือ</th>
                <th style="text-align:center">09-12</th>
                <th style="text-align:center">13-16</th>
                <th style="text-align:center">สถานะ</th>
                <th style="text-align:center">Action</th>
            </tr>
        </thead>
        <tbody>
            {% set count = {'value': 0} %}
            {% for row in data %}
            {% if count.value is divisibleby(2) %}
            <tr style="background-color:white">
            {% else %}
            <tr style="background-color:ivory">
            {% endif %}
                <td style="text-align:center">{{ row.0 }}</td>
                <td style="text-align:center">{{ row.2 }}</td>
                <td style="text-align:center">{{ row.18 }}</td>
                <td style="text-align:center">{{ row.3 }}</td>
                <td style="text-align:center">{{ row.4 }}</td>
                <td style="text-align:center">{{ row.5 }}</td>
                <td style="text-align:center">{{ row.6 }}</td>
                <td style="text-align:center">{{ row.7 }}</td>
                <td style="text-align:center">{{ row.8 }}</td>
                <td style="text-align:center">{{ row.9 }}</td>
                <td style="text-align:center">{{ row.10 }}</td>
                <td style="text-align:center">
                    {% if row.11 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.12 == 1 %}
                        &#x2713;
                    {% else %}
                        &nbsp
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.13 == "Approve" %}
                        <span style="color:green">{{ row.13 }}</span>
                    {% elif row.13 == "Pending" %}
                        {{ row.13 }}
                    {% else %}
                        <span style="color:red">{{ row.13 }}</span>
                    {% endif %}
                </td>
                <td style="text-align:center">
                    {% if row.13 == "Pending" %}
                        <a href="/fesem_approve/{{ row.0 }}" class="btn btn-success btn-xs" onclick="return confirm('คุณต้องการยืนยันการจองหรือไม่?')">Approve</a><br>
                        <a href="/fesem_edit/{{ row.0 }}" class="btn btn-warning btn-xs" onclick="return confirm('คุณต้องการแก้ไขข้อมูลหรือไม่?')">Edit</a><br>
                        <a href="/fesem_cancel/{{ row.0 }}" class="btn btn-danger btn-xs" onclick="return confirm('คุณต้องการยกเลิกการจองหรือไม่?')">Cancel</a>
                    {% elif row.13 == "Approve" %}
                        <a href="/fesem_cancel/{{ row.0 }}" class="btn btn-danger btn-xs" onclick="return confirm('คุณต้องการยกเลิกการจองหรือไม่?')">Cancel</a>   
                    {% else %}
                        ---
                    {% endif %}
                </td>
            </tr>
            {% if count.update({'value': (count.value + 1)}) %} {% endif %}
            {% endfor %}
        </tbody>
    </table>
    {% if user %}
        <a href="{{ url_for('fesem_add') }}" class="btn btn-success">จองใช้เครื่องมือ</a>
    {% endif %}
    <span class="pull-right">Updated : <span id="datetime"></span></span>
    <script>
        var dt = new Date();
        document.getElementById("datetime").innerHTML = dt.toLocaleString();
    </script>
    <script>
        $(function () {
            $('#datetimepicker1').datetimepicker({
                daysOfWeekDisabled: [0, 6],
                format: 'L',
                format: 'DD-MM-YYYY'
            });
        });
    </script>
</div>
{% endblock %}
